{% extends 'dssgmkt/org.html' %}

{% block tabcontents %}

  <h2>Membership request review</h2>
  <p>This person has requested to join your organization. Please review the
  application and accept or reject it.</p>

  <p>Full name:<a href="{% url 'dssgmkt:user_profile' organizationmembershiprequest.user.id %}">
    {{ organizationmembershiprequest.user.first_name }} {{ organizationmembershiprequest.user.last_name }}</a></p>
  <p>Email addres:<a href="{% url 'dssgmkt:user_profile' organizationmembershiprequest.user.id %}">
    {{ organizationmembershiprequest.user.email }}</a></p>
  <p>Request date: {{ organizationmembershiprequest.request_date }} </p>


  {% if organizationmembershiprequest.is_new %}
    {% if user_is_administrator %}
      <form id="orgmembershiprequestreview">
      {% csrf_token %}
      {{ form.as_p }}

      <button type="submit"
              form="orgmembershiprequestreview"
              formaction="{% url 'dssgmkt:org_staff_request_review_do' organization.id organizationmembershiprequest.id 'accept' %}"
              formmethod="post">Accept membership request</button>

      <button type="submit"
              form="orgmembershiprequestreview"
              formaction="{% url 'dssgmkt:org_staff_request_review_do' organization.id organizationmembershiprequest.id 'reject' %}"
              formmethod="post">Reject membership request</button>

      </form>
    {% endif %}
  {% else %}
    <p>Request status: {{ organizationmembershiprequest.get_status_display }}
        {% if organizationmembershiprequest.is_new and user_is_administrator %}
          <a href="{% url 'dssgmkt:org_staff_request_review' organization.id organizationmembershiprequest.id %}">Accept/reject request<a>
        {% endif %}
    </p>
      <p>Resolution date: {{ organizationmembershiprequest.resolution_date }}</p>
    {% if organizationmembershiprequest.public_reviewer_comments %}
      <p>Reviewer's comments: {{ organizationmembershiprequest.public_reviewer_comments }}</p>
    {% endif %}
    {% if user_is_member and organizationmembershiprequest.private_reviewer_notes %}
      <p>Private reviewer's notes: {{ organizationmembershiprequest.private_reviewer_notes }}</p>
    {% endif %}
  {% endif %}

  <a href="{% url 'dssgmkt:org_staff' organization.id %}">Back</a>
{% endblock %}
