{% extends "dssgmkt/proj.html" %}

{% block tabcontents %}

  {% load rules %}
  {% load markdown_deux_tags %}

  <div class="row section-header">
    <div class="col-lg-8">
      <h4>Project scope {% if not showing_current_scope %} (as of {{ current_scope.creation_date }}){% endif %}</h4>
    </div>

    <div class="col-lg-4">
      {% has_perm 'project.scope_edit' user project as perm_scope_edit %}
      {% if current_scope and showing_current_scope and perm_scope_edit %}
        <a class="btn btn-success col-lg-12 mb-1"
           href="{% url 'dssgmkt:proj_scope_edit' project.id current_scope.id %}">
          <i class="material-icons" style="vertical-align: middle">edit</i>
          Edit project scope
        </a>
      {% endif %}
    </div>
  </div>

  {{ current_scope.scope|markdown }}

  <h5 class="section-header">Project impact</h5>
  {{ current_scope.project_impact|markdown }}

  <h5 class="section-header">Scoping process</h5>
  {{ current_scope.scoping_process|markdown }}

  <h5 class="section-header">Available staff</h5>
  {{ current_scope.available_staff|markdown }}

  <h5 class="section-header">Available data</h5>
  {{ current_scope.available_data|markdown }}

  <h4 class="section-header">Scope version notes</h4>
  <ul class="list-group list-group-flush mb-3">
    {% for scope in project_scopes %}
      <li class="list-group-item {% if current_scope and scope.creation_date > current_scope.creation_date %}bg-light{% endif %}">
        <div class="row">
          <div class="col-lg-3">
            <div class="text-right"><a href="{% url 'dssgmkt:user_profile' scope.author.id %}">{{ scope.author }}</a></div>
            <div class="text-right text-muted">{{ scope.creation_date }}</div>
          </div>
          <div class="col-lg-1">
            {% if scope != current_scope %}
              <a href="{% url 'dssgmkt:proj_scope_previous' project.id scope.id %}">View</a>
            {% else %}
              Showing
            {% endif %}
          </div>
          <div class="col-lg-8">
            {{ scope.version_notes|markdown }}
          </div>
        </div>
      </li>
    {% endfor %}
  </ul>

  {% url 'dssgmkt:proj_scope' as proj_scope_url %}
  {% include 'dssgmkt/components/pagination.html' with baseurl=proj_scope_url page_obj=project_scopes %}

{% endblock %}
